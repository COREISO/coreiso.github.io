<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAS COREISO</title>
    <link rel="shortcut icon" href="./images/malaysia-airlines-icon.png" type="image/x-icon">
    <link rel="stylesheet" href="./news.css">
</head>
<body>
    <header>
        <div class="center">
            <img src="./images/malaysia-airlines-logo-white.png" alt="">
            <div class="text" id="hct"></div>
            <div class="news">PROMPT!</div>
            <script>
                const currentDate_ = new Date();  
                const currentYear = currentDate_.getFullYear();  
                const currentMonth = String(currentDate_.getMonth() + 1).padStart(2, '0');
                let hct = document.querySelector('#hct');
                hct.textContent = `NEWSROOM ${currentYear}.${currentMonth}`;
            </script>
        </div>
    </header>

    <div class="main">
        <div class="center">
        </div>
        <script>
            function containsPromptInsensitive(obj) {  
                // Helper function to recursively check properties  
                function check(value) {  
                    // Convert the value to a string (if it's not already) and to lower case  
                    const strValue = String(value).toLowerCase();  
                    
                    // Check if the string value contains 'prompt' (case insensitive)  
                    if (strValue.includes('prompt')) {  
                        return true;  
                    } else if (Array.isArray(value)) {  
                        // Iterate over array elements  
                        for (let item of value) {  
                            if (check(item)) {  
                                return true;  
                            }  
                        }  
                    } else if (value !== null && typeof value === 'object') {  
                        // Iterate over object properties  
                        for (let key in value) {  
                            if (value.hasOwnProperty(key) && check(value[key])) {  
                                return true;  
                            }  
                        }  
                    }  
                    return false;  
                }  
            
                // Start checking from the root object  
                return check(obj);  
            }
            fetch('./words/titles.json')  
                .then(response => {  
                    if (!response.ok) {  
                        throw new Error('Network response was not ok');  
                    }  
                    return response.json();  
                })  
                .then(data => {  
                    const container = document.querySelector('.main .center');  
                    for (const key in data) {  
                        if (data.hasOwnProperty(key)) {  
                            const div = document.createElement('div');  
                            div.textContent = data[key];
                            div.setAttribute('data-key', key);
                            container.appendChild(div);
                            div.addEventListener('click', function() {
                                window.location.href = './detail.htm';
                                const clickedKey = this.getAttribute('data-key');
                                LS_VAL = 'detail' + clickedKey.charAt(clickedKey.length - 1);
                                localStorage.setItem('local', LS_VAL);
                            });
                        }  
                    }

                    if(containsPromptInsensitive(data)){
                        const newsElements = document.querySelectorAll('.main .center div');  
                        newsElements.forEach(newsElement => {  
                            newsElement.classList.add('transition-dot2s');
                            newsElement.addEventListener('mouseenter', () => {  
                                newsElement.classList.add('hover-effect1');  
                            });  
                            newsElement.addEventListener('mouseleave', () => {  
                                newsElement.classList.remove('hover-effect1');  
                            });  
                        }); 
                    }
                    if (!containsPromptInsensitive(data)) {
                        let news = document.querySelector('header .news');
                        news.style.display = 'none';
                        const newsElements = document.querySelectorAll('.main .center div');  
                        newsElements.forEach(newsElement => {  
                            newsElement.classList.add('transition-dot2s');
                            newsElement.addEventListener('mouseenter', () => {  
                                newsElement.classList.add('hover-effect2');  
                            });  
                            newsElement.addEventListener('mouseleave', () => {  
                                newsElement.classList.remove('hover-effect2');  
                            });  
                        }); 

                    }
                })
                .catch(error => {  
                    console.error('Failed to fetch data:', error);
                });
        </script>
    </div>

    <footer>
        <div class="center">
            &copy; Malaysia Airlines - Coreiso 2024
        </div>
        <script>
            const currentDate2 = new Date();  
            const currentYear2 = currentDate2.getFullYear();  
            let fc = document.querySelector('footer .center');
            fc.innerHTML = `&copy; Malaysia Airlines - Coreiso ${currentYear}`;
        </script>
    </footer>
</body>
</html>