<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAS COREISO</title>
    <link rel="shortcut icon" href="./resource/images/malaysia-airlines-icon.png" type="image/x-icon">
    <link rel="stylesheet" href="./resource/index.css">
    <script>
        logSTR1 = 'Developed by MAS COREISO, Hosted by GitHub Pages'
        logSTR2 = 'MAS COREISO 2024. All rights reserved'
        console.log(logSTR1);
        console.log(logSTR2);
    </script>
</head>
<body>
    <header>
        <div class="center">
            <img src="./resource/images/malaysia-airlines-logo-white.png" alt="">
            <div class="text" id="hct"></div>
            <div class="news">NEWSROOM</div>
            <script>
                const currentDateNR = new Date();  
                const currentYearNR = currentDateNR.getFullYear();  
                const currentMonthNR = String(currentDateNR.getMonth() + 1).padStart(2, '0');
                let hct = document.querySelector('#hct');
                hct.textContent = `COREISO ${currentYearNR}.${currentMonthNR}`;
                let news = document.querySelector('.news');  
                news.addEventListener('click', function() {  
                    window.location.href = './resource/news.htm';
                });

                function containsPromptInsensitive(obj) {  
                    // Helper function to recursively check properties  
                    function check(value) {  
                        // Convert the value to a string (if it's not already) and to lower case  
                        const strValue = String(value).toLowerCase();  
                        
                        // Check if the string value contains 'prompt' (case insensitive)  
                        if (strValue.includes('prompt')) {  
                            return true;  
                        } else if (Array.isArray(value)) {  
                            // Iterate over array elements  
                            for (let item of value) {  
                                if (check(item)) {  
                                    return true;  
                                }  
                            }  
                        } else if (value !== null && typeof value === 'object') {  
                            // Iterate over object properties  
                            for (let key in value) {  
                                if (value.hasOwnProperty(key) && check(value[key])) {  
                                    return true;  
                                }  
                            }  
                        }  
                        return false;  
                    }  
                
                    // Start checking from the root object  
                    return check(obj);  
                }

                fetch('./resource/words/titles.json')  
                    .then(response => {
                        if (!response.ok) {  
                            throw new Error('Network response was not ok');  
                        }  
                        return response.json();  
                    })
                    .then(data => { 
                        if (containsPromptInsensitive(data)) {  
                            let news = document.querySelector('.news');  
                            let texts = ['NEWSROOM', 'PROMPT!'];  
                            let currentIndex = 0;
                            news.classList.add('border-8b0000');
                            news.classList.add('font-color-8b0000');
                            news.classList.add('transition-dot5s');
                            function switchText() { 
                                news.classList.add('fade-out');
                                setTimeout(() => {
                                    news.textContent = texts[currentIndex];
                                    news.classList.remove('fade-out');
                                    currentIndex = (currentIndex + 1) % texts.length;
                                    setTimeout(switchText, 4000);
                                }, 500);  
                            }
                            switchText();  
                        }
                        if (!containsPromptInsensitive(data)) {
                            const newsElements = document.querySelectorAll('.news');  
                            newsElements.forEach(newsElement => {  
                                newsElement.classList.add('transition-dot2s');
                                newsElement.classList.add('border-1d5b99');
                                newsElement.classList.add('font-color-1d5b99');
                                newsElement.addEventListener('mouseenter', () => {  
                                    newsElement.classList.add('hover-effect');  
                                });  
                        
                                newsElement.addEventListener('mouseleave', () => {  
                                    newsElement.classList.remove('hover-effect');  
                                });  
                            }); 
                        }  
                    })  
                    .catch(error => {  
                        console.error('Failed to fetch data:', error);  
                    });
            </script>
        </div>
    </header>

    <div class="main">
        <div class="center">
            <div class="carousel">  
                <div class="carousel-images">  
                    <img src="./resource/images/MRM/39369_1204038162.jpg" class="carousel-image active">
                    <img src="./resource/images/MRM/15405_1289120892.jpg" class="carousel-image">
                    <img src="./resource/images/MRM/16203_1201118595.jpg" class="carousel-image">
                    <img src="./resource/images/MRM/19434_1098088826.jpg" class="carousel-image">
                    <img src="./resource/images/MRM/21815_1093466710.jpg" class="carousel-image">
                    <img src="./resource/images/MRM/30592_1188813977.jpg" class="carousel-image">
                    <img src="./resource/images/MRM/31692_1334075306.jpg" class="carousel-image">
                    <img src="./resource/images/MRM/45504_1439577825.jpg" class="carousel-image">
                    <img src="./resource/images/MRM/47082_1066581840.jpg" class="carousel-image">
                    <img src="./resource/images/MRM/47230_1144217120.jpg" class="carousel-image">
                    <img src="./resource/images/MRM/50843_1178641589.jpg" class="carousel-image">
                    <img src="./resource/images/MRM/66224_1586380348.jpg" class="carousel-image">
                    <img src="./resource/images/MRM/83446_1204713084.jpg" class="carousel-image">
                    <img src="./resource/images/MRM/89824_1216881783.jpg" class="carousel-image">
                    <img src="./resource/images/MRM/94131_1377690821.jpg" class="carousel-image">
                    <img src="./resource/images/MRM/55271_1277051953.jpg" class="carousel-image">
                </div>  
            </div>
            <script>
                document.addEventListener('DOMContentLoaded', () => {  
                    const images = document.querySelectorAll('.carousel-image');  
                    let currentIndex = 0;  
                    const totalImages = images.length;  
                    function showNextImage() {  
                        images[currentIndex].classList.remove('active'); 
                        rand = Math.floor(Math.random() * totalImages);   
                        currentIndex = (currentIndex + rand) % totalImages;  
                        images[currentIndex].classList.add('active');  
                    }  
                    // Set an interval to change images every x seconds  
                    setInterval(showNextImage, 20000);  
                    // Initially show the first image  
                    images[currentIndex].classList.add('active');  
                });
            </script>

            <div class="text" id="text" title="RTFN: Real-Time Flight Number">
                <p>Malaysia Airlines B777-200ER</p>
                <p class="rtfn_dp"></p>
            </div>
            <script>
                function flightNumberGEN() {
                    const currentDateFNGEN = new Date();
                    const month = String(currentDateFNGEN.getMonth() + 1).padStart(2, '0');
                    const day = String(currentDateFNGEN.getDate()).padStart(2, '0');
                    return`MH${month}${day}`;
                }
                function RTFN() {  
                    const daysOfWeek = ['SUNDAY', 'MONDAY', 'TUESDAY', 'WEDNESDAY', 'THURSDAY', 'FRIDAY', 'SATURDAY'];  
                    const currentDateRTFN = new Date();  
                    const currentDayRTFN = currentDateRTFN.getDay(); // 获取当前是周几（0-6）  
                    const currentHourRTFN = currentDateRTFN.getHours();  
                    const currentMinuteRTFN = currentDateRTFN.getMinutes();  
                    const formattedMinuteRTFN = currentMinuteRTFN < 10 ? '0' + currentMinuteRTFN : currentMinuteRTFN;  
                    const currentTimeRTFN = `${currentHourRTFN}:${formattedMinuteRTFN}`;  
                
                    let prefix;  
                    if (currentHourRTFN >= 6 && currentHourRTFN < 12) {  
                        prefix = 'A';  
                    } else if (currentHourRTFN >= 12 && currentHourRTFN < 18) {  
                        prefix = 'B';  
                    } else if (currentHourRTFN >= 18 && currentHourRTFN < 24) {  
                        prefix = 'C';  
                    } else { // 00:00 <= currentHourRTFN < 06:00  
                        prefix = 'D';  
                    }  
                
                    return flightNumberGEN() + prefix + ' ' + currentTimeRTFN + ' ' + daysOfWeek[currentDayRTFN];  
                }  
                function RTFN_Display() {
                    let rtfn_dp = document.querySelector('#text .rtfn_dp')
                    rtfn_dp.textContent = 'RTFN: ' + RTFN()
                }
                setInterval(RTFN_Display, 60000);
                RTFN_Display();
            </script>
            <div class="information">
                <div class="top" id="clickableDiv">Click to view information</div>
                <script>
                    document.getElementById('clickableDiv').addEventListener('click', function() {  
                        let target = document.getElementById('targetSection');  
                        target.scrollIntoView({ behavior: 'smooth' });
                    });
                </script>
                <div class="info" id="targetSection">
                    <div class="up">
                        <img src="./resource/images/MRM/39369_1204038162.jpg" alt="">
                        <div>
                            <span class="sp1">9M-MRM</span><br>
                            <span class="sp2">Boeing 777-2H6(ER) - 29066, Operated by Malaysia Airlines</span><br>
                            <span class="sp3">MANUFACTURE DATE:</span>
                            <span class="sp4">2001-04-11</span><br>
                            <span class="sp5"></span>
                            <script>
                                const currentDate = new Date();
                                const startDate = new Date(2001, 3, 11);
                                const yearDiff = currentDate.getFullYear() - startDate.getFullYear();
                                let monthDiff = currentDate.getMonth() - startDate.getMonth();  
                                let dayDiff = currentDate.getDate() - startDate.getDate(); 
                                if (monthDiff < 0 || (monthDiff === 0 && dayDiff < 0)) {  
                                    yearDiff--;  
                                    monthDiff += 12;  
                                    const prevMonthDate = new Date(currentDate.getFullYear(), currentDate.getMonth(), 0);  
                                    dayDiff += prevMonthDate.getDate() + 1 - startDate.getDate(); 
                                    dayDiff = 0;
                                }
                                let sp5 = document.querySelector('.sp5');  
                                let result = `Age: ${yearDiff} years ${monthDiff} months`;  
                                sp5.textContent = result;
                            </script>
                        </div>
                    </div>
                    <div class="dw">
                       <div class="s1">
                        <span class="t1">AIRCRAFT INFORMATION</span>
                        <div class="separate"></div>
                        <span class="t2">CN/MSN: 29066</span><br>
                        <span class="t2">Line No: 336</span><br>
                        <span class="t2">Registration: 9M-MRM</span><br>
                        <span class="t2">Airline: Malaysia Airlines</span><br>
                        <span class="t2">Delivery Date: 2001-04-24</span><br>
                        <span class="t2">Engine Model: Rolls-Royce TRENT 892B-17</span><br>
                        <span class="t2">SELCAL:QR-CM</span><br>
                        <span class="t2">Status: Active</span>
                       </div> 
                       <div class="s2">
                        <span class="t1">REGISTRATION HISTORY</span>
                        <div class="separate"></div>
                        <table>
                            <thead>
                                <tr>
                                    <th>REG</th>
                                    <th>OPB</th>
                                    <th>DATE</th>
                                    <th>STATUS</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>9M-MRM</td>
                                    <td>Malaysia Airlines</td>
                                    <td>2001-04-24</td>
                                    <td>Active</td>
                                </tr>
                                <tr>
                                    <td>N439PH</td>
                                    <td>AerCap Holdings N.V.</td>
                                    <td>2016-10-20</td>
                                    <td>Inactive</td>
                                </tr>
                                <tr>
                                    <td>N752EI</td>
                                    <td>Avolon holding Limited</td>
                                    <td>2020-08-11</td>
                                    <td>Inactive</td>
                                </tr>
                                <tr>
                                    <td>9M-MRM</td>
                                    <td>MAS COREISO</td>
                                    <td>2024-04-24</td>
                                    <td>Active</td>
                                </tr>
                            </tbody>
                        </table>
                       </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="center">
            &copy; Malaysia Airlines - Coreiso 2024
        </div>
        <script>
            const currentDateF = new Date();  
            const currentYearF = currentDateF.getFullYear();  
            let fc = document.querySelector('footer .center');
            fc.innerHTML = `&copy; Malaysia Airlines - Coreiso ${currentYearF}`;
        </script>
    </footer>
</body>
</html>